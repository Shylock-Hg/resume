#!/bin/bash -e

os="$(uname -s | tr [A-Z] [a-z])"
linux_chrome="google-chrome-stable"
darwin_chrome="/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome"

chrome() {
  eval "local chrome_cmd=\$${os}_chrome"
  eval "$chrome_cmd --headless --virtual-time-budget=10000 $@"
}

main() {  
  options="$@"
  if [ "root" = "$USER" ] ; then
    options="--no-sandbox $@"
  fi

  chrome "$options"
}

main "$@"